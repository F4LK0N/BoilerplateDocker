#!/bin/sh
set -e

echo "### CONTAINER SETUP ###";

if [[ -f "${OS_DATA}/container/setup-done" ]]; then

    echo "[OK]";

else
    
    echo "FILESYSTEM - CLEAR";
    rm -r -f ${OS_DATA}/container;
    
    
    echo "FILESYSTEM - CREATE";
    # Container
    mkdir -p --mode=777 ${ROOT_DATA};
    # OS
    mkdir -p --mode=777 ${OS_DATA};
    mkdir -p --mode=777 ${OS_DATA}/container;

    echo "FILESYSTEM - PERMISSIONS";
    # Container
    chmod 777 ${ROOT_DATA};
    # OS
    chmod 777 ${OS_DATA};
    chmod 777 ${OS_DATA}/container;


    touch "${OS_DATA}/container/setup-done"
    chmod 777 "${OS_DATA}/container/setup-done"
    echo "[DONE]"

fi
